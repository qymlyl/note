"use strict";(self.webpackChunkstudy_note=self.webpackChunkstudy_note||[]).push([[1930],{3905:(e,n,l)=>{l.d(n,{Zo:()=>u,kt:()=>g});var i=l(7294);function t(e,n,l){return n in e?Object.defineProperty(e,n,{value:l,enumerable:!0,configurable:!0,writable:!0}):e[n]=l,e}function o(e,n){var l=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),l.push.apply(l,i)}return l}function r(e){for(var n=1;n<arguments.length;n++){var l=null!=arguments[n]?arguments[n]:{};n%2?o(Object(l),!0).forEach((function(n){t(e,n,l[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(l)):o(Object(l)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(l,n))}))}return e}function c(e,n){if(null==e)return{};var l,i,t=function(e,n){if(null==e)return{};var l,i,t={},o=Object.keys(e);for(i=0;i<o.length;i++)l=o[i],n.indexOf(l)>=0||(t[l]=e[l]);return t}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)l=o[i],n.indexOf(l)>=0||Object.prototype.propertyIsEnumerable.call(e,l)&&(t[l]=e[l])}return t}var a=i.createContext({}),s=function(e){var n=i.useContext(a),l=n;return e&&(l="function"==typeof e?e(n):r(r({},n),e)),l},u=function(e){var n=s(e.components);return i.createElement(a.Provider,{value:n},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var n=e.children;return i.createElement(i.Fragment,{},n)}},m=i.forwardRef((function(e,n){var l=e.components,t=e.mdxType,o=e.originalType,a=e.parentName,u=c(e,["components","mdxType","originalType","parentName"]),p=s(l),m=t,g=p["".concat(a,".").concat(m)]||p[m]||d[m]||o;return l?i.createElement(g,r(r({ref:n},u),{},{components:l})):i.createElement(g,r({ref:n},u))}));function g(e,n){var l=arguments,t=n&&n.mdxType;if("string"==typeof e||t){var o=l.length,r=new Array(o);r[0]=m;var c={};for(var a in n)hasOwnProperty.call(n,a)&&(c[a]=n[a]);c.originalType=e,c[p]="string"==typeof e?e:t,r[1]=c;for(var s=2;s<o;s++)r[s]=l[s];return i.createElement.apply(null,r)}return i.createElement.apply(null,l)}m.displayName="MDXCreateElement"},8263:(e,n,l)=>{l.r(n),l.d(n,{assets:()=>a,contentTitle:()=>r,default:()=>d,frontMatter:()=>o,metadata:()=>c,toc:()=>s});var i=l(7462),t=(l(7294),l(3905));const o={id:"build_riscv_toolchain_docker_img",title:"Dockerfile\u6784\u5efariscv-gnu-toolchain\u955c\u50cf"},r=void 0,c={unversionedId:"risc-v/build_riscv_toolchain_docker_img",id:"risc-v/build_riscv_toolchain_docker_img",title:"Dockerfile\u6784\u5efariscv-gnu-toolchain\u955c\u50cf",description:"elf-gcc",source:"@site/docs/risc-v/build_riscv_toolchain_docker_img.md",sourceDirName:"risc-v",slug:"/risc-v/build_riscv_toolchain_docker_img",permalink:"/note/risc-v/build_riscv_toolchain_docker_img",draft:!1,tags:[],version:"current",frontMatter:{id:"build_riscv_toolchain_docker_img",title:"Dockerfile\u6784\u5efariscv-gnu-toolchain\u955c\u50cf"},sidebar:"tutorialSidebar",previous:{title:"ubuntu\u5b89\u88c5riscv-gnu-toolchain",permalink:"/note/risc-v/ubuntu-install-riscv-gnu-toolchain"},next:{title:"\u5c0f\u5de5\u5177",permalink:"/note/rust/little-tools"}},a={},s=[{value:"elf-gcc",id:"elf-gcc",level:2},{value:"glibc-gcc",id:"glibc-gcc",level:2},{value:"musl-gcc",id:"musl-gcc",level:2},{value:"\u542f\u52a8\u793a\u4f8b",id:"\u542f\u52a8\u793a\u4f8b",level:2},{value:"\u521b\u5efa\u5bb9\u5668",id:"\u521b\u5efa\u5bb9\u5668",level:3},{value:"\u8fdb\u5165\u5bb9\u5668",id:"\u8fdb\u5165\u5bb9\u5668",level:3},{value:"\u67e5\u770b\u7248\u672c\u4fe1\u606f",id:"\u67e5\u770b\u7248\u672c\u4fe1\u606f",level:3},{value:"\u7f16\u8bd1\u8fd0\u884cC\u7a0b\u5e8f(hello_world.c)",id:"\u7f16\u8bd1\u8fd0\u884cc\u7a0b\u5e8fhello_worldc",level:3},{value:"\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u548c\u6e90\u7801\u76ee\u5f55",id:"\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u548c\u6e90\u7801\u76ee\u5f55",level:3},{value:"\u95ee\u9898",id:"\u95ee\u9898",level:2},{value:"\u955c\u50cf\u592a\u5927\u4e86",id:"\u955c\u50cf\u592a\u5927\u4e86",level:3},{value:"source: not found",id:"source-not-found",level:3},{value:"Dependency &quot;pixman-1&quot; not found",id:"dependency-pixman-1-not-found",level:3}],u={toc:s},p="wrapper";function d(e){let{components:n,...l}=e;return(0,t.kt)(p,(0,i.Z)({},u,l,{components:n,mdxType:"MDXLayout"}),(0,t.kt)("h2",{id:"elf-gcc"},"elf-gcc"),(0,t.kt)("p",null,"\u57fa\u4e8eubuntu 22.04\u6784\u5efa"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-shell"},"vim Dockerfile\n")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-dockerfile"},"# \u4f7f\u7528\u5b98\u65b9\u7684 Ubuntu 22.04 \u955c\u50cf\u4f5c\u4e3a\u57fa\u7840\u955c\u50cf\nFROM ubuntu:22.04\n\n# \u8bbe\u7f6e\u955c\u50cf\u7684\u7ef4\u62a4\u8005\u4fe1\u606f\nLABEL maintainer=\"qymlyl\"\n\n# \u7528\u6237\u9ed8\u8ba4\u662froot\uff0c\u76ee\u5f55\u9ed8\u8ba4\u662f/\uff0cWORKDIR\u8bbe\u7f6e\u9ed8\u8ba4\u7684\u5de5\u4f5c\u76ee\u5f55\nWORKDIR /opt/source\n\n# \u8fd0\u884c\u66f4\u65b0\u547d\u4ee4\u4ee5\u83b7\u53d6\u6700\u65b0\u7684\u8f6f\u4ef6\u5305\u5217\u8868\u5e76\u5b89\u88c5\u5fc5\u8981\u7684\u5de5\u5177\nRUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get install -y openssh-server vim autoconf automake autotools-dev curl python3 python3-pip libmpc-dev libmpfr-dev libgmp-dev gawk build-essential bison flex texinfo gperf libtool patchutils bc zlib1g-dev libexpat-dev ninja-build git cmake libglib2.0-dev libpixman-1-0 libpixman-1-dev\n\n# clone riscv-gun-tool\u53ca\u5b50\u6a21\u5757\nRUN curl https://mirror.iscas.ac.cn/riscv-toolchains/git/riscv-collab/riscv-gnu-toolchain.sh | bash\n\n# \u7f16\u8bd1riscv-gnu-toolchain\n# --enable-multilib:\u6784\u5efa\u652f\u6301 32 \u4f4d\u548c 64 \u4f4d\u7684\u4ea4\u53c9\u7f16\u8bd1\u5668\nRUN cd riscv-gnu-toolchain && \\\n    ./configure --prefix=/opt/riscv --enable-multilib && \\\n    make -j$(nproc) && \\\n    make -j$(nproc) build-sim SIM=qemu QEMU_TARGETS=riscv64-linux-user,riscv32-linux-user,riscv64-softmmu,riscv32-softmmu\n      \n# \u8bbe\u7f6e RISCV\u53d8\u91cf\nRUN echo 'export RISCV=/opt/riscv' >> /etc/profile && \\\n    echo 'export PATH=$RISCV/bin:$PATH' >> /etc/profile && \\\n    /bin/bash -c 'source /etc/profile' && \\\n    echo 'export RISCV=/opt/riscv' >> ~/.bashrc && \\\n    echo 'export PATH=$RISCV/bin:$PATH' >> ~/.bashrc && \\\n    /bin/bash -c 'source ~/.bashrc'\n\n# \u5c06\u9ed8\u8ba4\u5de5\u4f5c\u76ee\u5f55\u8bbe\u7f6e\u5728/\nWORKDIR /\n\n# \u5220\u9664\u6e90\u7801\nRUN rm -rf /opt/source\n\n# \u5b9a\u4e49\u5bb9\u5668\u542f\u52a8\u65f6\u8fd0\u884c\u7684\u547d\u4ee4\nCMD [\"bash\"]\n")),(0,t.kt)("p",null,"\u6784\u5efa\u955c\u50cf"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-shell"},"# \u6784\u5efa\u65b0\u7684\u7248\u672c\u65f6\u6ce8\u610f\u6e05\u9664\u6784\u5efa\u7f13\u5b58\ndocker builder prune\n")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-shell"},"# \u57fa\u4e8eamd64 ubuntu22.04\u955c\u50cf\u6784\u5efa\u7684\u652f\u6301riscv64\u548criscv32\u4e24\u79cd\u67b6\u6784\u7684elf-gcc\u548cqemu\n# \u62c9\u53d6\u7684\u662f\u5b98\u65b9\u6700\u65b0\u7684\u4ee3\u7801\n# \u8fd9\u91cc\u5bf9\u5e94\u5b98\u65b92024/7/3\u7684\u63d0\u4ea4\uff0c commitid: 1358115963fb55cc445535d8a931e2f51dbe1940\nnohup docker build -t riscv-gnu-toolchain:elf_gcc_qemu_HEADE_1358115 . &\n")),(0,t.kt)("p",null,"\u955c\u50cf\u538b\u7f29"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-shell"},"# \u672a\u538b\u7f29\u4e4b\u524d20G(\u5305\u542b\u6e90\u7801\u5c42)\uff0c\u538b\u7f29\u540e2G\ndocker-squash riscv-gnu-toolchain:elf_gcc_qemu_HEADE_1358115 \\\n-t riscv-gnu-toolchain:elf_gcc_qemu_HEADE_1358115_squashed\n")),(0,t.kt)("h2",{id:"glibc-gcc"},"glibc-gcc"),(0,t.kt)("p",null,"\u57fa\u4e8eubuntu 22.04\u6784\u5efa"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-dockerfile"},"# \u4f7f\u7528\u5b98\u65b9\u7684 Ubuntu 22.04 \u955c\u50cf\u4f5c\u4e3a\u57fa\u7840\u955c\u50cf\nFROM ubuntu:22.04\n\n# \u8bbe\u7f6e\u955c\u50cf\u7684\u7ef4\u62a4\u8005\u4fe1\u606f\nLABEL maintainer=\"qymlyl\"\n\n# \u7528\u6237\u9ed8\u8ba4\u662froot\uff0c\u76ee\u5f55\u9ed8\u8ba4\u662f/\uff0cWORKDIR\u8bbe\u7f6e\u9ed8\u8ba4\u7684\u5de5\u4f5c\u76ee\u5f55\nWORKDIR /opt/source\n\n# \u8fd0\u884c\u66f4\u65b0\u547d\u4ee4\u4ee5\u83b7\u53d6\u6700\u65b0\u7684\u8f6f\u4ef6\u5305\u5217\u8868\u5e76\u5b89\u88c5\u5fc5\u8981\u7684\u5de5\u5177\nRUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get install -y openssh-server vim autoconf automake autotools-dev curl python3 python3-pip libmpc-dev libmpfr-dev libgmp-dev gawk build-essential bison flex texinfo gperf libtool patchutils bc zlib1g-dev libexpat-dev ninja-build git cmake libglib2.0-dev libpixman-1-0 libpixman-1-dev\n\n# clone riscv-gun-tool\u53ca\u5b50\u6a21\u5757\nRUN curl https://mirror.iscas.ac.cn/riscv-toolchains/git/riscv-collab/riscv-gnu-toolchain.sh | bash\n\n# \u7f16\u8bd1riscv-gnu-toolchain\n# --enable-multilib:\u6784\u5efa\u652f\u6301 32 \u4f4d\u548c 64 \u4f4d\u7684\u4ea4\u53c9\u7f16\u8bd1\u5668\nRUN cd riscv-gnu-toolchain && \\\n    ./configure --prefix=/opt/riscv --enable-multilib && \\\n    make linux -j$(nproc) && \\\n      make -j$(nproc) build-sim SIM=qemu QEMU_TARGETS=riscv64-linux-user,riscv32-linux-user,riscv64-softmmu,riscv32-softmmu\n\n# \u8bbe\u7f6e RISCV\u53d8\u91cf\nRUN echo 'export RISCV=/opt/riscv' >> /etc/profile && \\\n    echo 'export PATH=$RISCV/bin:$PATH' >> /etc/profile && \\\n    /bin/bash -c 'source /etc/profile' && \\\n    echo 'export RISCV=/opt/riscv' >> ~/.bashrc && \\\n    echo 'export PATH=$RISCV/bin:$PATH' >> ~/.bashrc && \\\n    /bin/bash -c 'source ~/.bashrc'\n\n# \u5c06\u9ed8\u8ba4\u5de5\u4f5c\u76ee\u5f55\u8bbe\u7f6e\u5728home\u76ee\u5f55\nWORKDIR /\n\n# \u5b9a\u4e49\u5bb9\u5668\u542f\u52a8\u65f6\u8fd0\u884c\u7684\u547d\u4ee4\nCMD [\"bash\"]\n")),(0,t.kt)("p",null,"\u6784\u5efa\u955c\u50cf"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-shell"},"# \u6784\u5efa\u65b0\u7684\u7248\u672c\u65f6\u6ce8\u610f\u6e05\u9664\u6784\u5efa\u7f13\u5b58\ndocker builder prune\n")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-shell"},"nohup docker build -t riscv-gnu-toolchain:glibc_gcc_qemu_HEADE_1358115 . &\n")),(0,t.kt)("p",null,"\u955c\u50cf\u538b\u7f29"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-shell"},"# \u672a\u538b\u7f29\u4e4b\u524d20G(\u5305\u542b\u6e90\u7801\u5c42)\uff0c\u538b\u7f29\u540e2G\ndocker-squash riscv-gnu-toolchain:glibc_gcc_qemu_HEADE_13581155 \\\n-t riscv-gnu-toolchain:glibc_gcc_qemu_HEADE_1358115_squashed\n")),(0,t.kt)("h2",{id:"musl-gcc"},"musl-gcc"),(0,t.kt)("p",null,"\u57fa\u4e8eubuntu 22.04\u6784\u5efa"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-dockerfile"},"# \u4f7f\u7528\u5b98\u65b9\u7684 Ubuntu 22.04 \u955c\u50cf\u4f5c\u4e3a\u57fa\u7840\u955c\u50cf\nFROM ubuntu:22.04\n\n# \u8bbe\u7f6e\u955c\u50cf\u7684\u7ef4\u62a4\u8005\u4fe1\u606f\nLABEL maintainer=\"qymlyl\"\n\n# \u7528\u6237\u9ed8\u8ba4\u662froot\uff0c\u76ee\u5f55\u9ed8\u8ba4\u662f/\uff0cWORKDIR\u8bbe\u7f6e\u9ed8\u8ba4\u7684\u5de5\u4f5c\u76ee\u5f55\nWORKDIR /opt/source\n\n# \u8fd0\u884c\u66f4\u65b0\u547d\u4ee4\u4ee5\u83b7\u53d6\u6700\u65b0\u7684\u8f6f\u4ef6\u5305\u5217\u8868\u5e76\u5b89\u88c5\u5fc5\u8981\u7684\u5de5\u5177\nRUN apt-get update && \\\n    apt-get upgrade -y && \\\n    apt-get install -y openssh-server vim autoconf automake autotools-dev curl python3 python3-pip libmpc-dev libmpfr-dev libgmp-dev gawk build-essential bison flex texinfo gperf libtool patchutils bc zlib1g-dev libexpat-dev ninja-build git cmake libglib2.0-dev libpixman-1-0 libpixman-1-dev\n\n# clone riscv-gun-tool\u53ca\u5b50\u6a21\u5757\nRUN curl https://mirror.iscas.ac.cn/riscv-toolchains/git/riscv-collab/riscv-gnu-toolchain.sh | bash\n\n# \u7f16\u8bd1riscv-gnu-toolchain\n# --enable-multilib:\u6784\u5efa\u652f\u6301 32 \u4f4d\u548c 64 \u4f4d\u7684\u4ea4\u53c9\u7f16\u8bd1\u5668\uff08\u5bf9\u4e8emul\u5e76\u6ca1\u6709\u8d77\u4f5c\u7528\uff0cmul\u53ea\u652f\u630164\u4f4d\u67b6\u6784\uff09\nRUN cd riscv-gnu-toolchain && \\\n    ./configure --prefix=/opt/riscv --enable-multilib && \\\n    make musl -j$(nproc) && \\\n    make -j$(nproc) build-sim SIM=qemu QEMU_TARGETS=riscv64-linux-user,riscv32-linux-user,riscv64-softmmu,riscv32-softmmu\n\n# \u8bbe\u7f6e RISCV\u53d8\u91cf\nRUN echo 'export RISCV=/opt/riscv' >> /etc/profile && \\\n    echo 'export PATH=$RISCV/bin:$PATH' >> /etc/profile && \\\n    /bin/bash -c 'source /etc/profile' && \\\n    echo 'export RISCV=/opt/riscv' >> ~/.bashrc && \\\n    echo 'export PATH=$RISCV/bin:$PATH' >> ~/.bashrc && \\\n    /bin/bash -c 'source ~/.bashrc'\n\n# \u5c06\u9ed8\u8ba4\u5de5\u4f5c\u76ee\u5f55\u8bbe\u7f6e\u5728home\u76ee\u5f55\nWORKDIR /\n\n# \u5b9a\u4e49\u5bb9\u5668\u542f\u52a8\u65f6\u8fd0\u884c\u7684\u547d\u4ee4\nCMD [\"bash\"]\n")),(0,t.kt)("p",null,"\u6784\u5efa\u955c\u50cf"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-shell"},"# \u6784\u5efa\u65b0\u7684\u7248\u672c\u65f6\u6ce8\u610f\u6e05\u9664\u6784\u5efa\u7f13\u5b58\ndocker builder prune\n")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-shell"},"nohup docker build -t riscv-gnu-toolchain:musl_gcc_qemu_HEADE_1358115 . &\n")),(0,t.kt)("p",null,"\u955c\u50cf\u538b\u7f29"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-shell"},"docker-squash riscv-gnu-toolchain:musl_gcc_qemu_HEADE_1358115 -t riscv-gnu-toolchain:musl_gcc_qemu_HEADE_1358115_squashed\n")),(0,t.kt)("h2",{id:"\u542f\u52a8\u793a\u4f8b"},"\u542f\u52a8\u793a\u4f8b"),(0,t.kt)("p",null,"\u4ee5elf_gcc\u4e3a\u4f8b"),(0,t.kt)("h3",{id:"\u521b\u5efa\u5bb9\u5668"},"\u521b\u5efa\u5bb9\u5668"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-shell"},"# riscv toolchain\u662f\u57fa\u4e8eubuntu 22.04\u955c\u50cf\u8fdb\u884c\u6784\u5efa\uff0c\u8fd9\u91cc\u8bbe\u7f6e\u4e00\u4e2a\u7aef\u53e3\u4e0e22\u7aef\u53e3\u8fdb\u884c\u6620\u5c04\u4fbf\u4e8e\u4f7f\u7528ssh\u94fe\u63a5\ndocker run --name riscv64_elf_gcc \\\n-p 10022:22 \\\n-itd  mqylyl/riscv-gnu-toolchain:elf_gcc_qemu_HEADE_1358115\n")),(0,t.kt)("h3",{id:"\u8fdb\u5165\u5bb9\u5668"},"\u8fdb\u5165\u5bb9\u5668"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-shell"},"docker exec -it riscv64_elf_gcc /bin/bash\n")),(0,t.kt)("h3",{id:"\u67e5\u770b\u7248\u672c\u4fe1\u606f"},"\u67e5\u770b\u7248\u672c\u4fe1\u606f"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-shell"},"$ riscv64-unknown-elf-gcc -v\nUsing built-in specs.\nCOLLECT_GCC=riscv64-unknown-elf-gcc\nCOLLECT_LTO_WRAPPER=/opt/riscv/libexec/gcc/riscv64-unknown-elf/13.2.0/lto-wrapper\nTarget: riscv64-unknown-elf\nConfigured with: /opt/source/riscv-gnu-toolchain/gcc/configure --target=riscv64-unknown-elf --prefix=/opt/riscv --disable-shared --disable-threads --enable-languages=c,c++ --with-pkgversion=gc891d8dc23e --with-system-zlib --enable-tls --with-newlib --with-sysroot=/opt/riscv/riscv64-unknown-elf --with-native-system-header-dir=/include --disable-libmudflap --disable-libssp --disable-libquadmath --disable-libgomp --disable-nls --disable-tm-clone-registry --src=.././gcc --enable-multilib --with-abi=lp64d --with-arch=rv64imafdc --with-tune=rocket --with-isa-spec=20191213 'CFLAGS_FOR_TARGET=-Os    -mcmodel=medlow' 'CXXFLAGS_FOR_TARGET=-Os    -mcmodel=medlow'\nThread model: single\nSupported LTO compression algorithms: zlib\ngcc version 13.2.0 (gc891d8dc23e) \n")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-shell"},"$ qemu-system-riscv64 -version\nQEMU emulator version 8.1.1 (v8.1.1)\nCopyright (c) 2003-2023 Fabrice Bellard and the QEMU Project developers\n")),(0,t.kt)("h3",{id:"\u7f16\u8bd1\u8fd0\u884cc\u7a0b\u5e8fhello_worldc"},"\u7f16\u8bd1\u8fd0\u884cC\u7a0b\u5e8f(hello_world.c)"),(0,t.kt)("p",null,"\u7f16\u5199hello_world.c\u6587\u4ef6"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-c"},"echo '#include <stdio.h>' > hello_world.c && \\\necho 'int main() {' >> hello_world.c && \\\necho '    printf(\"Hello, world!\\n\");' >> hello_world.c && \\\necho '    return 0;' >> hello_world.c && \\\necho '}' >> hello_world.c\n")),(0,t.kt)("p",null,"\u7f16\u8bd1\u8fd0\u884criscv64"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-shell"},"# \u7f16\u8bd1\n$ riscv64-unknown-elf-gcc -march=rv64imafdc -mabi=lp64 -o hello_world_64 hello_world.c\n\n# \u67e5\u770b\u4e8c\u8fdb\u5236\u6587\u4ef6\u683c\u5f0f\uff0c64-bit\n$ file hello_world_64 \nhello_world_64: ELF 64-bit LSB executable, UCB RISC-V, RVC, soft-float ABI, version 1 (SYSV), statically linked, with debug_info, not stripped\n\n# \u4f7f\u7528qemu\u8fd0\u884c\u7a0b\u5e8f\n# qemu-riscv64\uff1auser mode\u8fd0\u884c\n# -L: \u7528\u4e8e\u52a0\u8f7d\u6a21\u62df\u5668\u7684\u4f53\u7cfb\u7ed3\u6784\u652f\u6301\u6587\u4ef6\u7684\u76ee\u5f55\uff08risc-v\u7684\u4e00\u4e9b\u5e93\u90fd\u5728$RISCV/sysroot\u76ee\u5f55\u4e0b\uff09\n# qemu-riscv64 -L $RISCV/sysroot ./hello_world_64\n$ qemu-riscv64 ./hello_world_64\nhello world!\n")),(0,t.kt)("p",null,"\u7f16\u8bd1\u8fd0\u884criscv32"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-shell"},"# \u7f16\u8bd1\n$ riscv64-unknown-elf-gcc -march=rv32imafdc -mabi=ilp32 -o hello_world_32 hello_world.c\n\n# \u67e5\u770b\u4e8c\u8fdb\u5236\u6587\u4ef6\u683c\u5f0f\uff0c32-bit\n$ file hello_world_32\nhello_world_32: ELF 32-bit LSB executable, UCB RISC-V, RVC, soft-float ABI, version 1 (SYSV), statically linked, with debug_info, not strippe\n\n# \u8fd0\u884c\n$ qemu-riscv32 ./hello_world_32\nhello world!\n")),(0,t.kt)("h3",{id:"\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u548c\u6e90\u7801\u76ee\u5f55"},"\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u548c\u6e90\u7801\u76ee\u5f55"),(0,t.kt)("p",null,"\u4e8c\u8fdb\u5236\u7a0b\u5e8f\u653e\u5728\u5728",(0,t.kt)("inlineCode",{parentName:"p"},"/opt/riscv")),(0,t.kt)("h2",{id:"\u95ee\u9898"},"\u95ee\u9898"),(0,t.kt)("h3",{id:"\u955c\u50cf\u592a\u5927\u4e86"},"\u955c\u50cf\u592a\u5927\u4e86"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-shell"},"$ docker images riscv-gnu-toolchain:riscv6432_elf_gcc_qemu_20231018_nightly_ubuntu2204_arm64\nREPOSITORY            TAG                                                        IMAGE ID       CREATED             SIZE\nriscv-gnu-toolchain   riscv6432_elf_gcc_qemu_20231018_nightly_ubuntu2204_arm64   e272d8d35157   About an hour ago   22.1GB\n")),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-shell"},'$ docker history riscv-gnu-toolchain:riscv6432_elf_gcc_qemu_20231018_nightly_ubuntu2204_arm64\nIMAGE          CREATED             CREATED BY                                      SIZE      COMMENT\ne272d8d35157   About an hour ago   CMD ["bash"]                                    0B        buildkit.dockerfile.v0\n<missing>      About an hour ago   WORKDIR /                                       0B        buildkit.dockerfile.v0\n<missing>      About an hour ago   RUN /bin/sh -c echo \'export RISCV=/opt/riscv\u2026   3.79kB    buildkit.dockerfile.v0\n<missing>      About an hour ago   RUN /bin/sh -c cd riscv-gnu-toolchain &&    \u2026   12.1GB    buildkit.dockerfile.v0\n<missing>      7 hours ago         RUN /bin/sh -c curl https://mirror.iscas.ac.\u2026   9.42GB    buildkit.dockerfile.v0\n<missing>      9 hours ago         RUN /bin/sh -c apt-get update &&     apt-get\u2026   528MB     buildkit.dockerfile.v0\n<missing>      9 hours ago         WORKDIR /opt/source                             0B        buildkit.dockerfile.v0\n<missing>      9 hours ago         LABEL maintainer=qymlyl                         0B        buildkit.dockerfile.v0\n<missing>      3 weeks ago         /bin/sh -c #(nop)  CMD ["/bin/bash"]            0B        \n<missing>      3 weeks ago         /bin/sh -c #(nop) ADD file:f8594e26831508c31\u2026   69.2MB    \n<missing>      3 weeks ago         /bin/sh -c #(nop)  LABEL org.opencontainers.\u2026   0B        \n<missing>      3 weeks ago         /bin/sh -c #(nop)  LABEL org.opencontainers.\u2026   0B        \n<missing>      3 weeks ago         /bin/sh -c #(nop)  ARG LAUNCHPAD_BUILD_ARCH     0B        \n<missing>      3 weeks ago         /bin/sh -c #(nop)  ARG RELEASE                  0B \n')),(0,t.kt)("h3",{id:"source-not-found"},"source: not found"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-shell"}," > [6/6] RUN echo 'export RISCV=/opt/riscv' >> /etc/profile &&     echo 'export PATH=$RISCV/bin:$PATH' >> /etc/profile &&     source /etc/profile &&     echo 'export RISCV=/opt/riscv' >> ~/.bashrc &&     echo 'export PATH=$RISCV/bin:$PATH' >> ~/.bashrc &&     source ~/.bashrc:\n0.296 /bin/sh: 1: source: not found\n------\n")),(0,t.kt)("p",null,"\u89e3\u51b3\u65b9\u6848\uff1a\u4f7f\u7528",(0,t.kt)("inlineCode",{parentName:"p"},"/bin/bash -c source")),(0,t.kt)("h3",{id:"dependency-pixman-1-not-found"},'Dependency "pixman-1" not found'),(0,t.kt)("p",null,"\u7f16\u8bd1Qemu\u65f6\u9047\u5230"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-shell"},'un-time dependency pixman-1 found: NO (tried pkgconfig)\n\n../qemu/meson.build:840:11: ERROR: Dependency "pixman-1" not found, tried pkgconfig\n\nA full log can be found at /home/parallels/Wokspace/study/riscv/riscv-gnu-toolchain/build-qemu/meson-logs/meson-log.txt\n\nERROR: meson setup failed\n\nmake: *** [Makefile:903: stamps/build-qemu] Error 1\n')),(0,t.kt)("p",null,"\u89e3\u51b3\u65b9\u6848\uff1a"),(0,t.kt)("pre",null,(0,t.kt)("code",{parentName:"pre",className:"language-shell"},"sudo apt-get install libpixman-1-0 libpixman-1-dev\n")))}d.isMDXComponent=!0}}]);