"use strict";(self.webpackChunkstudy_note=self.webpackChunkstudy_note||[]).push([[9422],{3905:(e,n,t)=>{t.d(n,{Zo:()=>c,kt:()=>b});var a=t(7294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)t=s[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)t=s[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var d=a.createContext({}),i=function(e){var n=a.useContext(d),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},c=function(e){var n=i(e.components);return a.createElement(d.Provider,{value:n},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},k=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,s=e.originalType,d=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),p=i(t),k=r,b=p["".concat(d,".").concat(k)]||p[k]||u[k]||s;return t?a.createElement(b,l(l({ref:n},c),{},{components:t})):a.createElement(b,l({ref:n},c))}));function b(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var s=t.length,l=new Array(s);l[0]=k;var o={};for(var d in n)hasOwnProperty.call(n,d)&&(o[d]=n[d]);o.originalType=e,o[p]="string"==typeof e?e:r,l[1]=o;for(var i=2;i<s;i++)l[i]=t[i];return a.createElement.apply(null,l)}return a.createElement.apply(null,t)}k.displayName="MDXCreateElement"},4912:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>l,default:()=>u,frontMatter:()=>s,metadata:()=>o,toc:()=>i});var a=t(7462),r=(t(7294),t(3905));const s={},l=void 0,o={unversionedId:"tools/k8s_dashboard_install",id:"tools/k8s_dashboard_install",title:"k8s_dashboard_install",description:"\u5b89\u88c5docker\u955c\u50cf\u4ed3\u5e93",source:"@site/docs/tools/k8s_dashboard_install.md",sourceDirName:"tools",slug:"/tools/k8s_dashboard_install",permalink:"/note/zh-Hans/tools/k8s_dashboard_install",draft:!1,tags:[],version:"current",frontMatter:{}},d={},i=[{value:"\u5b89\u88c5docker\u955c\u50cf\u4ed3\u5e93",id:"\u5b89\u88c5docker\u955c\u50cf\u4ed3\u5e93",level:2},{value:"\u5b89\u88c5k3s",id:"\u5b89\u88c5k3s",level:2},{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:3},{value:"\u83b7\u53d6token",id:"\u83b7\u53d6token",level:3},{value:"work\u52a0\u5165\u96c6\u7fa4",id:"work\u52a0\u5165\u96c6\u7fa4",level:3},{value:"\u68c0\u67e5",id:"\u68c0\u67e5",level:3},{value:"\u5378\u8f7d",id:"\u5378\u8f7d",level:3},{value:"dashboard\u5b89\u88c5",id:"dashboard\u5b89\u88c5",level:2},{value:"\u5173\u95edtoken\u767b\u5f55",id:"\u5173\u95edtoken\u767b\u5f55",level:3},{value:"http\u8bbf\u95ee",id:"http\u8bbf\u95ee",level:3},{value:"\u56fa\u5b9a\u7aef\u53e3\u793a\u4f8b",id:"\u56fa\u5b9a\u7aef\u53e3\u793a\u4f8b",level:3},{value:"\u90e8\u7f72",id:"\u90e8\u7f72",level:3},{value:"token\u83b7\u53d6(\u65b9\u5f0f\u8bbf\u95ee\u9700\u8981)",id:"token\u83b7\u53d6\u65b9\u5f0f\u8bbf\u95ee\u9700\u8981",level:3},{value:"\u6c49\u5316",id:"\u6c49\u5316",level:3},{value:"\u5176\u4ed6\u547d\u4ee4",id:"\u5176\u4ed6\u547d\u4ee4",level:2}],c={toc:i},p="wrapper";function u(e){let{components:n,...t}=e;return(0,r.kt)(p,(0,a.Z)({},c,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"\u5b89\u88c5docker\u955c\u50cf\u4ed3\u5e93"},"\u5b89\u88c5docker\u955c\u50cf\u4ed3\u5e93"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"cd docker-registry\n")),(0,r.kt)("p",null,"\u6267\u884c\u811a\u672c"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"\u6ce8\uff1a\u9700\u4fee\u6539setup_registry.sh\u4e2d\u7684\u6570\u636e\u5b58\u653e\u4f4d\u7f6e")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"./setup_registry.sh\n")),(0,r.kt)("p",null,"\u914d\u7f6e\u955c\u50cf\u4ed3\u5e93"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"# \u8bbe\u7f6edocker\u79c1\u6709\u955c\u50cf\u4ed3\u5e93\u7684\u57df\u540d\u4fe1\u606f\nvim /etc/hosts        \n192.168.16.147 docker.oa.com\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'vim /etc/docker/daemon.json \n\u6dfb\u52a0 \n{\n "insecure-registries": ["docker.oa.com:5000"]\n}\n')),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"systemctl daemon-reload && systemctl restart docker\n")),(0,r.kt)("h2",{id:"\u5b89\u88c5k3s"},"\u5b89\u88c5k3s"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/k3s-io/k3s/tree/v1.21.4%2Bk3s1"},"https://github.com/k3s-io/k3s/tree/v1.21.4%2Bk3s1")),(0,r.kt)("h3",{id:"\u5b89\u88c5"},"\u5b89\u88c5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'# \u9ed8\u8ba4\ncurl -sfL https://get.k3s.io | INSTALL_K3S_VERSION=v1.21.4+k3s1 sh -\n\n\ncurl -sfL https://get.k3s.io | INSTALL_K3S_VERSION=v1.21.4+k3s1 INSTALL_K3S_EXEC="server --docker --disable traefik --write-kubeconfig-mode 644" sh -\n\n# \u56fd\u5185\u955c\u50cf\ncurl -sfL https://rancher-mirror.rancher.cn/k3s/k3s-install.sh | INSTALL_K3S_VERSION=v1.21.4+k3s1 INSTALL_K3S_EXEC="server --docker --disable traefik --write-kubeconfig-mode 644"   INSTALL_K3S_MIRROR=cn sh -\n')),(0,r.kt)("h3",{id:"\u83b7\u53d6token"},"\u83b7\u53d6token"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"cat /var/lib/rancher/k3s/server/node-token\n")),(0,r.kt)("h3",{id:"work\u52a0\u5165\u96c6\u7fa4"},"work\u52a0\u5165\u96c6\u7fa4"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'curl -sfL http://rancher-mirror.cnrancher.com/k3s/k3s-install.sh | INSTALL_K3S_VERSION=v1.18.8+k3s1  INSTALL_K3S_EXEC="agent --flannel-iface wlan0 --docker --disable traefik" INSTALL_K3S_MIRROR=cn  K3S_URL=https://10.0.0.18:6443 K3S_TOKEN=K10d647b2b9964d759ffb54581236d57af7d18fd798cd87f3c7d9e6f2dd861c74b9::server:05112474d0b177915915752629e8f1a3 sh\n')),(0,r.kt)("h3",{id:"\u68c0\u67e5"},"\u68c0\u67e5"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"\u6267\u884c\u5982\u4e0b\u547d\u4ee4\uff1a\nkubectl get node \nkubectl get pod -A\n")),(0,r.kt)("h3",{id:"\u5378\u8f7d"},"\u5378\u8f7d"),(0,r.kt)("p",null,"\u5378\u8f7d K3s Server"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"sudo /usr/local/bin/k3s-uninstall.sh\n")),(0,r.kt)("p",null,"\u5378\u8f7d K3s Agent\uff0c\u5982\u679c\u4f60\u6b63\u5728\u8fd0\u884c K3s agent \u8282\u70b9\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u6765\u5378\u8f7d K3s agent\uff1a"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"/usr/local/bin/k3s-agent-uninstall.sh\n")),(0,r.kt)("p",null,"\u5378\u8f7d\u6b8b\u7559\u6587\u4ef6"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"sudo rm -rf /etc/rancher/k3s /var/lib/rancher/k3s /var/log/k3s.log\n")),(0,r.kt)("p",null,"\u68c0\u67e5\u8fdb\u7a0b"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"ps aux | grep k3s\n")),(0,r.kt)("h2",{id:"dashboard\u5b89\u88c5"},"dashboard\u5b89\u88c5"),(0,r.kt)("p",null,"\u5bf9\u5e94k8s\u7248\u672c\uff1av1.21.4+k3s1"),(0,r.kt)("p",null,"GitHub: ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/kubernetes/dashboard/tree/v2.3.1"},"https://github.com/kubernetes/dashboard/tree/v2.3.1")),(0,r.kt)("p",null,"\u4e0b\u8f7d\u90e8\u7f72\u6587\u4ef6(\u90e8\u7f72\u6587\u4ef6\u4f1a\u653e\u5728\u9644\u5f55)"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"# \u9ed8\u8ba4\u7684\n$ wget https://raw.githubusercontent.com/kubernetes/dashboard/v2.3.1/aio/deploy/recommended.yaml\n")),(0,r.kt)("h3",{id:"\u5173\u95edtoken\u767b\u5f55"},"\u5173\u95edtoken\u767b\u5f55"),(0,r.kt)("p",null,"\u4fee\u6539recommended.yaml\uff0c\u627e\u5230kubernetes-dashboard\u5bf9\u5e94\u7684",(0,r.kt)("inlineCode",{parentName:"p"},"kind: Deploment"),"\uff0c \u4fee\u6539",(0,r.kt)("inlineCode",{parentName:"p"},"spec.template.spec.containers.args")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"args:\n  # \u5173\u95edtoken\u767b\u5f55\n  #- --auto-generate-certificates\n  - --namespace=kubernetes-dashboard\n  #- --enable-skip-login\n  #- --disable-settings-authorizer\n  - --kubeconfig=/etc/kubernetes/kubeconfig\n  # Uncomment the following line to manually specify Kubernetes API server Host\n  # If not specified, Dashboard will attempt to auto discover the API server and connect\n  # to it. Uncomment only if the default does not work.\n  #- --apiserver-host=https://192.168.100.1:6443\n")),(0,r.kt)("p",null,"\u4fee\u6539",(0,r.kt)("inlineCode",{parentName:"p"},"spec.template.spec.containers.env")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"}," env:\n  - name: KUBECONFIG\n    value: /etc/kubernetes/kubeconfig\n")),(0,r.kt)("p",null,"\u4fee\u6539",(0,r.kt)("inlineCode",{parentName:"p"},"spec.template.spec.volumes"),", \u6dfb\u52a0"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"volumes:\n  - name: kubeconfig\n    hostPath:\n        path: /etc/rancher/k3s/k3s.yaml\n        type: File\n")),(0,r.kt)("h3",{id:"http\u8bbf\u95ee"},"http\u8bbf\u95ee"),(0,r.kt)("p",null,"http\u8bbf\u95ee\u53c2\u8003\u6587\u7ae0",(0,r.kt)("a",{parentName:"p",href:"https://www.cnblogs.com/chen2ha/p/17086962.html"},"https://www.cnblogs.com/chen2ha/p/17086962.html")),(0,r.kt)("h3",{id:"\u56fa\u5b9a\u7aef\u53e3\u793a\u4f8b"},"\u56fa\u5b9a\u7aef\u53e3\u793a\u4f8b"),(0,r.kt)("p",null,"nodePort\u4e3a\u5bbf\u4e3b\u673a\u4e0a\u7684\u7aef\u53e3"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"apiVersion: v1\nkind: Service\nmetadata:\n  labels:\n    k8s-app: kubernetes-dashboard\n  name: kubernetes-dashboard\n  namespace: kubernetes-dashboard\nspec:\n  ports:\n  - name: https\n    nodePort: 30110\n    port: 443\n    protocol: TCP\n    targetPort: 8443\n  - name: http\n    nodePort: 31213\n    port: 80\n    protocol: TCP\n    targetPort: 9090\n  selector:\n    k8s-app: kubernetes-dashboard\n  type: NodePort\n")),(0,r.kt)("h3",{id:"\u90e8\u7f72"},"\u90e8\u7f72"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ kubectl apply -f dashboard_recommended.yaml\n")),(0,r.kt)("p",null,"\u67e5\u770bdashboard\u72b6\u6001"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ kubectl get pods -n kubernetes-dashboard\n\nNAME                                         READY   STATUS    RESTARTS   AGE\ndashboard-metrics-scraper-856586f554-2vb4m   1/1     Running   0          28s\nkubernetes-dashboard-865bddc59c-59q5f        1/1     Running   0          28s\n")),(0,r.kt)("p",null,"\u67e5\u770bsvc"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"created\nNAME                        TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)    AGE\nkubernetes-dashboard        ClusterIP   10.43.181.192   <none>        443/TCP    71s\ndashboard-metrics-scraper   ClusterIP   10.43.81.128    <none>        8000/TCP   71s\n")),(0,r.kt)("p",null,"\u66b4\u9732\u7aef\u53e3\uff0c\u5c06",(0,r.kt)("inlineCode",{parentName:"p"},"type: ClusterIP"),"\u4fee\u6539\u4e3a",(0,r.kt)("inlineCode",{parentName:"p"},"type: NodePort")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ kubectl -n kubernetes-dashboard edit service kubernetes-dashboard\n")),(0,r.kt)("p",null,"\u518d\u6b21\u67e5\u770bsvc"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ kubectl get svc -n kubernetes-dashboard\nNAME                        TYPE        CLUSTER-IP      EXTERNAL-IP   PORT(S)         AGE\ndashboard-metrics-scraper   ClusterIP   10.43.81.128    <none>        8000/TCP        3m38s\nkubernetes-dashboard        NodePort    10.43.181.192   <none>        443:30443/TCP   3m38s\n")),(0,r.kt)("h3",{id:"token\u83b7\u53d6\u65b9\u5f0f\u8bbf\u95ee\u9700\u8981"},"token\u83b7\u53d6(\u65b9\u5f0f\u8bbf\u95ee\u9700\u8981)"),(0,r.kt)("p",null,"\u60f3\u8981\u8bbf\u95eedashboard\u670d\u52a1\uff0c\u9700\u8981\u6709\u8bbf\u95ee\u6743\u9650\uff0c\u521b\u5efakubernetes-dashboard\u7ba1\u7406\u5458\u89d2\u8272"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ vim dashboard-svc-account.yaml\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"apiVersion: v1\nkind: ServiceAccount\nmetadata:\n  name: dashboard-admin\n  namespace: kube-system\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: dashboard-admin\nsubjects:\n  - kind: ServiceAccount\n    name: dashboard-admin\n    namespace: kube-system\nroleRef:\n  kind: ClusterRole\n  name: cluster-admin\n  apiGroup: rbac.authorization.k8s.io\n")),(0,r.kt)("p",null,"\u6216\u8005\u533f\u540d\u7528\u6237"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"apiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: dashboard-anonymous-admin\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: cluster-admin\nsubjects:\n- kind: User\n  name: system:anonymous\n  apiGroup: rbac.authorization.k8s.io\n")),(0,r.kt)("p",null,"\u6267\u884c\u6587\u4ef6"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ kubectl apply -f dashboard-svc-account.yaml\nserviceaccount/dashboard-admin created\nclusterrolebinding.rbac.authorization.k8s.io/dashboard-admin created\n")),(0,r.kt)("p",null,"\u83b7\u53d6token\u6587\u4ef6\u540d"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ kubectl get secret -n kube-system|grep admin|awk '{print $1}'\nadmin-service-account-token-rqczg\ndashboard-admin-token-rlqv5\n")),(0,r.kt)("p",null,"\u83b7\u53d6token"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ kubectl describe secret dashboard-admin-token-7vmj6 -n kube-system|awk '/^token/ {print $2}'\neyJhbGciOiJSUzI1NiIsImtpZCI6IkwzdTlqWWh5dUVQQnZ0WTZLTGlhcGwyOE5tVFR1d3VPNkZzWEh2dEFBYzAifQ.eyJpc3MiOiJrdWJlcm5ldGVzL3NlcnZpY2VhY2NvdW50Iiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9uYW1lc3BhY2UiOiJrdWJlLXN5c3RlbSIsImt1YmVybmV0ZXMuaW8vc2VydmljZWFjY291bnQvc2VjcmV0Lm5hbWUiOiJkYXNoYm9hcmQtYWRtaW4tdG9rZW4tN3ZtajYiLCJrdWJlcm5ldGVzLmlvL3NlcnZpY2VhY2NvdW50L3NlcnZpY2UtYWNjb3VudC5uYW1lIjoiZGFzaGJvYXJkLWFkbWluIiwia3ViZXJuZXRlcy5pby9zZXJ2aWNlYWNjb3VudC9zZXJ2aWNlLWFjY291bnQudWlkIjoiNTQ2MTJkNDEtOTM4OS00NmVjLWFjNzgtMGNlMjkyMjI3YzA1Iiwic3ViIjoic3lzdGVtOnNlcnZpY2VhY2NvdW50Omt1YmUtc3lzdGVtOmRhc2hib2FyZC1hZG1pbiJ9.T7rPQfnyU7ZhP1L2EZkgwoIWh6CtUwUo4AZojfvBCb2dOK1XxaXunkniDWedq2ui0TE-SKKoWpswzoUeGTsSM1zgF0t62v1ImbprOgjWehINTIRm5XSvqolDwQ4Hi0HXTy3OBHCMNQ1NJtrRLEPDOAHKieKUNphj0J75GMoqxEUw7Ob0WI4vCWZod_pRAm-kjYf68FJTvXR3yXmcCam4VCa1rrnMCtQTtapogQAcJCTekC9aYku092FaASa4akpR0_5mayfBMaRGxIBgvK2DuvrF8VmLPC7-fUeW3L7GssuceFOs2WPlwOHZ-m5X8yBx-uLYx2TB_pK9FZDEHC0K5Q\n")),(0,r.kt)("p",null,"\u6d4f\u89c8\u5668\u8bbf\u95ee",(0,r.kt)("a",{parentName:"p",href:"https://192.168.0.76:30443/"},"https://192.168.0.76:30443/")," (\u6ce8\u610f\u7aef\u53e3)"),(0,r.kt)("p",null,'\u53ef\u80fd\u4f1a\u663e\u793a"\u60a8\u7684\u8fde\u63a5\u4e0d\u662f\u79c1\u5bc6\u8fde\u63a5"'),(0,r.kt)("h3",{id:"\u6c49\u5316"},"\u6c49\u5316"),(0,r.kt)("p",null,"\u4fee\u6539\u6e90\u4ee3\u7801\u4e2d\u7684i18\u4e2d\u7684\u6587\u4ef6"),(0,r.kt)("p",null,"\u62c9\u53d6\u6e90\u4ee3\u7801\uff0c\u4fee\u6539\u6587\u4ef6\uff0c\u5c06\u6587\u4ef6\u4e2d\u7684\u82f1\u6587\u6539\u4e3a\u6c49\u5b57\uff0c",(0,r.kt)("a",{parentName:"p",href:"https://github.com/kubernetes/dashboard/tree/v2.3.1/i18n/zh-Hans%EF%BC%8C%E7%84%B6%E5%90%8E%E9%87%8D%E6%96%B0%E7%BC%96%E8%AF%91"},"https://github.com/kubernetes/dashboard/tree/v2.3.1/i18n/zh-Hans\uff0c\u7136\u540e\u91cd\u65b0\u7f16\u8bd1")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"npm ci\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"npm run docker:build\n")),(0,r.kt)("p",null,"\u4f1a\u751f\u6210\u51e0\u4e2a\u65b0\u7684\u955c\u50cf\uff0c\u67e5\u770b\u955c\u50cf\u5217\u8868"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"$ docker images\nREPOSITORY                                        TAG       IMAGE ID       CREATED         SIZE\nkubernetesui/dashboard-s390x                      v2.3.1    58e45411506b   8 hours ago     219MB\nkubernetesui/dashboard-arm64                      v2.3.1    366097b75ce9   8 hours ago     216MB\nkubernetesui/dashboard-amd64                      v2.3.1    525505c2dd48   8 hours ago     217MB\nkubernetesui/dashboard-ppc64le                    v2.3.1    84605e3f84e6   8 hours ago     216MB\n")),(0,r.kt)("p",null,"\u4f7f\u7528\u65b0\u955c\u50cf\u90e8\u7f72"),(0,r.kt)("h2",{id:"\u5176\u4ed6\u547d\u4ee4"},"\u5176\u4ed6\u547d\u4ee4"),(0,r.kt)("p",null,"\u67e5\u770b\u6307\u5b9a\u547d\u540d\u7a7a\u95f4\u7684deployment-name"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"$ kubectl get deployments -n kubernetes-dashboard\nNAME                        READY   UP-TO-DATE   AVAILABLE   AGE\ndashboard-metrics-scraper   1/1     1            1           16m\nkubernetes-dashboard        1/1     1            1           16m\n")),(0,r.kt)("p",null,"\u4fee\u6539deployment"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"kubectl edit deployment kubernetes-dashboard -n kubernetes-dashboard\nkubectl edit svc kubernetes-dashboard -n kubernetes-dashboard\n\nkubectl edit service/kubernetes-dashboard -n kubernetes-dashboard\n\n")),(0,r.kt)("p",null,"\u5220\u9664deployment"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"# \u5220\u9664\u547d\u540d\u7a7a\u95f4\nkubectl delete namespace kubernetes-dashboard\n\n\nkubectl delete deployment kubernetes-dashboard -n kubernetes-dashboard\n")),(0,r.kt)("p",null,"kubernetesui/dashboard:v2.3.1"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"kubectl logs -n kubernetes-dashboard kubernetes-dashboard-68fb47587d-ckpjf\n")),(0,r.kt)("p",null,"\u67e5\u770b\u6240\u6709\u7684\u547d\u540d\u7a7a\u95f4"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"kubectl get ns\n\nkubectl delete namespace kubernetes-dashboard\nkubectl delete namespace kuboard\n\nkubectl apply -f k8s_dashboard_recommended.yaml\n\nkubectl describe pod kubernetes-dashboard-775bd6b989-jph5f  -n kubernetes-dashboard\nkubectl logs kubernetes-dashboard-775bd6b989-7zzx7 -n kubernetes-dashboard --previous\n\nkubectl get nodes\n\nkubectl describe node ubuntu-linux-22-04-desktop\n\nkubectl get pods -n kubernetes-dashboard\n\n# --accept-hosts \u63a5\u53d7\u6240\u6709\u7684\u4e3b\u673a\u540d\nkubectl proxy --address='0.0.0.0' --port=20010 --accept-hosts='^*$'\n\n10.211.55.3\n\nkubectl get pods -n kubernetes-dashboard\nkubectl edit deployment kubernetes-dashboard -n kubernetes-dashboard\nkubectl delete deployment kubernetes-dashboard -n kubernetes-dashboard\n\nkubectl get deployments -n kubernetes-dashboard\n\nchmod 644 /etc/rancher/k3s/k3s.yaml\n\n\nkubectl exec -it kubernetes-dashboard-7f9899856b-fc5zh  -n kubernetes-dashboard -- /bin/sh\n\n\n--enable-insecure-login\n--disable-settings-authorizer\n--enable-insecure-login\n--kubeconfig \n")),(0,r.kt)("p",null,"\u95ee\u9898\uff1a"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"\u767b\u5f55\u9875\u9762\u9700\u8981token,  \u96c6\u6210\u7684\u65f6\u5019\u9700\u8981\u53bb\u6389\uff0c\u76ee\u524d\u6ca1\u6709\u529e\u6cd5\u53bb\u9664"),(0,r.kt)("li",{parentName:"ol"},"\u767b\u5f55\u65f6\uff0chttps\u63d0\u793a\u975e\u79c1\u5bc6\u94fe\u63a5\uff0c\u5e76\u4e14\u6ca1\u6709\u9ad8\u7ea7\u9009\u9879"),(0,r.kt)("li",{parentName:"ol"},"\u754c\u9762\u6c49\u5316\u95ee\u9898")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"Usage of /dashboard:\n      --alsologtostderr                  log to standard error as well as files\n      --api-log-level string             level of API request logging, should be one of 'NONE', 'INFO' or 'DEBUG' (default \"INFO\")\n      --apiserver-host string            address of the Kubernetes API server to connect to in the format of protocol://address:port, leave it empty if the binary runs inside cluster for local discovery attempt\n      --authentication-mode strings      enabled authentication options, supports 'token' and 'basic' that should only be used if Kubernetes API server has --authorization-mode=ABAC and --basic-auth-file flags set (default [token])\n      --auto-generate-certificates       enables automatic certificates generation used to serve HTTPS\n      --bind-address ip                  IP address on which to serve the --port, set to 0.0.0.0 for all interfaces (default 0.0.0.0)\n      --default-cert-dir string          directory path containing files from --tls-cert-file and --tls-key-file, used also when auto-generating certificates flag is set (default \"/certs\")\n      --disable-settings-authorizer      disables settings page user authorizer so anyone can access settings page\n      --enable-insecure-login            enables login view when the app is not served over HTTPS\n      --enable-skip-login                enables skip button on the login page\n      --heapster-host string             address of the Heapster API server to connect to in the format of protocol://address:port, leave it empty if the binary runs inside cluster for service proxy usage\n      --insecure-bind-address ip         IP address on which to serve the --insecure-port, set to 127.0.0.1 for all interfaces (default 127.0.0.1)\n      --insecure-port int                port to listen to for incoming HTTP requests (default 9090)\n      --kubeconfig string                path to kubeconfig file with authorization and master location information\n      --locale-config string             path to file containing the locale configuration (default \"./locale_conf.json\")\n      --log_backtrace_at traceLocation   when logging hits line file:N, emit a stack trace (default :0)\n      --log_dir string                   If non-empty, write log files in this directory\n      --logtostderr                      log to standard error instead of files\n      --metric-client-check-period int   time interval between separate metric client health checks in seconds (default 30)\n      --metrics-provider string          select provider type for metrics, 'none' will not check metrics (default \"sidecar\")\n      --namespace string                 if non-default namespace is used encryption key will be created in the specified namespace (default \"kube-system\")\n      --port int                         secure port to listen to for incoming HTTPS requests (default 8443)\n      --sidecar-host string              address of the Sidecar API server to connect to in the format of protocol://address:port, leave it empty if the binary runs inside cluster for service proxy usage\n      --stderrthreshold severity         logs at or above this threshold go to stderr (default 2)\n      --system-banner string             system banner message displayed in the app if non-empty, it accepts simple HTML\n      --system-banner-severity string    severity of system banner, should be one of 'INFO', 'WARNING' or 'ERROR' (default \"INFO\")\n      --tls-cert-file string             file containing the default x509 certificate for HTTPS\n      --tls-key-file string              file containing the default x509 private key matching --tls-cert-file\n      --token-ttl int                    expiration time in seconds of JWE tokens generated by dashboard, set to 0 to avoid expiration (default 900)\n  -v, --v Level                          log level for V logs\n      --vmodule moduleSpec               comma-separated list of pattern=N settings for file-filtered logging\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'# \u67e5\u770b\u79c1\u6709\u4ed3\u5e93\u4e2d\u955c\u50cf\u5217\u8868\ncurl -X GET http://docker.oa.com:5000/v2/_catalog\n\nkubectl get pods -n monitoring\nkubectl get svc -n monitoring\n\nkubectl delete namespace monitoring\n\nkubectl get svc -n grafana\nkubectl -n monitoring edit service grafana\n\nhttp://192.168.100.1:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/\nhttp://192.168.100.1:8001/api/v1/namespaces/monitoring/services/http:grafana:3000/proxy/\nhttp://192.168.100.1:8001/api/v1/namespaces/monitoring/services/http:grafana:/proxy/\n\n\nkubectl get namespace monitoring -o json > monitoring.json\n\u5220\u9664monitoring.json\u4e2d\u7684"finalizers": [\n      "kubernetes"\n    ]\nkubectl replace --raw "/api/v1/namespaces/monitoring/finalize" -f ./monitoring.json\n\nkubectl apply -f prometheus/setup/\nkubectl apply -f ./grafana-config.yaml  \nkubectl apply -f prometheus/\n\n\n\napiVersion: v1\nkind: Service\n  labels:\n\n    k8s-app: kubernetes-dashboard\n  name: kubernetes-dashboard\n  namespace: kubernetes-dashboard\nspec:\n  ports:\n  - name: https\n    nodePort: 30110\n    port: 443\n    protocol: TCP\n    targetPort: 8443\n  - name: http\n    nodePort: 31213\n    port: 80\n    protocol: TCP\n    targetPort: 9090\n  selector:\n    k8s-app: kubernetes-dashboard\n  type: NodePort\n  \n  \napiVersion: v1\nkind: Service\nmetadata:\n  labels:\n    k8s-app: kubernetes-dashboard\n  name: kubernetes-dashboard\n  namespace: kubernetes-dashboard\nspec:\n  ports:\n  - name: https\n    nodePort: 30110\n    port: 443\n    protocol: TCP\n    targetPort: 8443\n  - name: http\n    nodePort: 31213\n    port: 80\n    protocol: TCP\n    targetPort: 9090\n  selector:\n    k8s-app: kubernetes-dashboard\n  type: NodePort\n')))}u.isMDXComponent=!0}}]);