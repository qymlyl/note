<!doctype html>
<html lang="zh-Hans" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-rCore-Tutorial-Book学习/ch1-memory-layout-and-linker" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">ch1-程序内存布局与链接器 | qymlyl note</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://qymlyl.github.io/note/zh-Hans/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://qymlyl.github.io/note/zh-Hans/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://qymlyl.github.io/note/zh-Hans/rCore-Tutorial-Book学习/ch1-memory-layout-and-linker"><meta data-rh="true" name="docusaurus_locale" content="zh-Hans"><meta data-rh="true" name="docsearch:language" content="zh-Hans"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="ch1-程序内存布局与链接器 | qymlyl note"><meta data-rh="true" name="description" content="现代编译器基本流程：源代码（source code）→ 预处理器（preprocessor）→ 编译器（compiler）→ 汇编程序（assembler）→ 目标代码（object code）→ 链接器（linker）→ 可执行文件（executables），最后打包好的文件就可以给电脑去判读执行了。"><meta data-rh="true" property="og:description" content="现代编译器基本流程：源代码（source code）→ 预处理器（preprocessor）→ 编译器（compiler）→ 汇编程序（assembler）→ 目标代码（object code）→ 链接器（linker）→ 可执行文件（executables），最后打包好的文件就可以给电脑去判读执行了。"><link data-rh="true" rel="icon" href="/note/zh-Hans/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://qymlyl.github.io/note/zh-Hans/rCore-Tutorial-Book学习/ch1-memory-layout-and-linker"><link data-rh="true" rel="alternate" href="https://qymlyl.github.io/note/rCore-Tutorial-Book学习/ch1-memory-layout-and-linker" hreflang="en"><link data-rh="true" rel="alternate" href="https://qymlyl.github.io/note/zh-Hans/rCore-Tutorial-Book学习/ch1-memory-layout-and-linker" hreflang="zh-Hans"><link data-rh="true" rel="alternate" href="https://qymlyl.github.io/note/rCore-Tutorial-Book学习/ch1-memory-layout-and-linker" hreflang="x-default"><link rel="stylesheet" href="/note/zh-Hans/assets/css/styles.75314c4a.css">
<link rel="preload" href="/note/zh-Hans/assets/js/runtime~main.cffa1f8f.js" as="script">
<link rel="preload" href="/note/zh-Hans/assets/js/main.7f2867a2.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="跳到主要内容"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">跳到主要内容</a></div><nav aria-label="主导航" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><a class="navbar__brand" href="/note/zh-Hans/"><div class="navbar__logo"><img src="/note/zh-Hans/img/logo.svg" alt="qymlyl note Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/note/zh-Hans/img/logo.svg" alt="qymlyl note Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">qymlyl note</b></a></div><div class="navbar__items navbar__items--right"><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="切换浅色/暗黑模式（当前为浅色模式）" aria-label="切换浅色/暗黑模式（当前为浅色模式）" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="回到顶部" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="文档侧边栏" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/note/zh-Hans/home">首页</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/note/zh-Hans/tools/ubuntu-usage">工具</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/note/zh-Hans/ethereum/whitepaper">以太坊</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/note/zh-Hans/layer2/scroll_architecture">Layer2学习</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/note/zh-Hans/zkp_study/zkp_history">zkp学习</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/note/zh-Hans/risc-v/ubuntu-install-riscv-gnu-toolchain">risc-v</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/note/zh-Hans/rust/little-tools">Rust</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/note/zh-Hans/rCore-Tutorial-Book学习/ch1-setup-os-devel-env">rCore-Tutorial-Book学习</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/note/zh-Hans/rCore-Tutorial-Book学习/ch1-setup-os-devel-env">ch1-搭建OS实验环境</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/note/zh-Hans/rCore-Tutorial-Book学习/ch1-memory-layout-and-linker">ch1-程序内存布局与链接器</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="页面路径"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="主页面" class="breadcrumbs__link" href="/note/zh-Hans/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">rCore-Tutorial-Book学习</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">ch1-程序内存布局与链接器</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">本页总览</button></div><div class="theme-doc-markdown markdown"><header><h1>ch1-程序内存布局与链接器</h1></header><blockquote><p><a href="https://zh.wikipedia.org/wiki/%E7%B7%A8%E8%AD%AF%E5%99%A8" target="_blank" rel="noopener noreferrer">现代编译器基本流程</a>：<a href="https://zh.wikipedia.org/wiki/%E6%BA%90%E4%BB%A3%E7%A0%81" target="_blank" rel="noopener noreferrer">源代码</a>（source code）→ <a href="https://zh.wikipedia.org/wiki/%E9%A2%84%E5%A4%84%E7%90%86%E5%99%A8" target="_blank" rel="noopener noreferrer">预处理器</a>（preprocessor）→ <a href="https://zh.wikipedia.org/wiki/%E7%BC%96%E8%AF%91%E5%99%A8" target="_blank" rel="noopener noreferrer">编译器</a>（compiler）→ <a href="https://zh.wikipedia.org/wiki/%E6%B1%87%E7%BC%96%E7%A8%8B%E5%BA%8F" target="_blank" rel="noopener noreferrer">汇编程序</a>（assembler）→ <a href="https://zh.wikipedia.org/wiki/%E7%9B%AE%E6%A0%87%E4%BB%A3%E7%A0%81" target="_blank" rel="noopener noreferrer">目标代码</a>（object code）→ <a href="https://zh.wikipedia.org/wiki/%E9%93%BE%E6%8E%A5%E5%99%A8" target="_blank" rel="noopener noreferrer">链接器</a>（linker）→ <a href="https://zh.wikipedia.org/wiki/%E5%9F%B7%E8%A1%8C%E6%AA%94" target="_blank" rel="noopener noreferrer">可执行文件</a>（executables），最后打包好的文件就可以给电脑去判读执行了。</p><p>链接器(Linker)：将一个或者多个由编译器或者汇编器生成的目标文件和一些外部目标文件(库)链接为一个可执行二进制文件，即对所有输入的目标文件进行内存布局重新排布，整合为一个整体的的内存布局。</p><p>链接脚本文件：可以通过编写链接脚本文件来控制链接器对内存排列的顺序和布局，让最终生成的可执行文件的内存布局与我们所期待的一致。</p></blockquote><h2 class="anchor anchorWithStickyNavbar_LWe7" id="程序内存布局">程序内存布局<a href="#程序内存布局" class="hash-link" aria-label="程序内存布局的直接链接" title="程序内存布局的直接链接">​</a></h2><p>在将源代码编译为可执行二进制文件之后，就得到了一个由完全由字节组成的文件，这些字节可以划分为<code>代码</code>和<code>数据</code>两部分。</p><p><code>代码</code>部分：是由一条条指令组成，这些指令可以被CPU解码并执行。</p><p><code>数据</code>部分：是CPU可读写的内存空间。</p><p>而这两部分又可以根据其功能被划分为更为细小的单位：<strong><code>段(Section)</code></strong>，不同的段在会被编译器放在不同的位置，因此就组成了程序的<strong><code>内存布局(Memory Layout)</code></strong></p><p>一种比较经典的内存布局如下：</p><p><img loading="lazy" alt="经典的内存布局" src="/note/zh-Hans/assets/images/classic_memory_layout-fbb22e3095b4d40d811e1e125b5f8e22.png" title="经典的内存布局" width="2560" height="1440" class="img_ev3q"></p><p>代码部分只有<code>.text</code>一个段，而数据部分则被划分为了多个段：<code>.rodatad</code>、<code>.data</code>、<code>.bss</code>、<code>heap</code>、<code>stack</code></p><ul><li><code>.text</code>：存放程序的所有汇编代码</li><li><code>.rodata</code>：已初始化字段，存放只读的全局数据，如：常数、常量字符串等</li><li><code>.data</code>：已初始化字段，存放可修改的全局数据</li><li><code>.bss</code>：未初始化字段，保存未初始化的全局数据，通常是由程序的loader进行零初始化，即将这块区域的字节清零</li><li><code>heap（堆）</code>：用来存放程序运行时动态分配的数据，通常用来存放大小不确定、生命周期不确定的数据，<strong>是向高地址增长的</strong></li><li><code>stack（栈）</code>：用作函数调用上下文的保存与恢复，并且每个函数作用域内的局部变量也会被放入到栈帧中，栈的大小是在编译期就已经确定的，通常用来存放大小确定、生命周期确定的数据，<strong>是向低地址增长的（栈空间大小是确定的，空间提前被申请好了）</strong></li></ul><p>从一个函数的视角来看，它能够访问的变量有以下几种：</p><ul><li>函数的输入与局部变量：保存在一些寄存器或者是在该函数的栈帧里面，如果是在栈帧里面话是基于当前栈指针加上一个offset来访问的。</li><li>全局变量：保存在数据段<code>.data</code>和<code>.bss</code>中，某些情况下gp(x3)寄存器保存两个数据段中间的一个位置，即全局变量是基于gp加上一个偏移量来访问的。</li><li>堆上的动态变量：实际数据被保存在堆上，大小在运行时才能确定，而且<strong>我们只能访问编译期间能够确定大小的变量，即栈上或者全局数据段中的数据</strong>，因此需要通过一个运行时分配内存得到的一个<strong>指向堆上数据的指针来访问堆上的数据</strong>。指针的位宽在编译期间是能够确定的，该指针会作为局部变量被放在栈帧中，也可以作为全局变量放在全局数据段中。</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="编译与链接">编译与链接<a href="#编译与链接" class="hash-link" aria-label="编译与链接的直接链接" title="编译与链接的直接链接">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="简单编译流程">简单编译流程<a href="#简单编译流程" class="hash-link" aria-label="简单编译流程的直接链接" title="简单编译流程的直接链接">​</a></h3><p>源代码到可执行文件的编译过程大概可以分为下面几个阶段：</p><ol><li><strong>编译器</strong>（Compiler）将源代码文件从<strong>高级编程语言转化成汇编语言</strong>，此时输出的文件仍然是一个ASCII或者其他编码的文本文件。</li><li><strong>汇编器</strong>（Assembler）将上一步得到的<strong>汇编语言</strong>源文件中文本格式<strong>转化为机器码</strong>，得到一个<strong>二进制的目标文件</strong>（Object File）。</li><li><strong>链接器</strong>（Linker）将上一步得到的<strong>目标文件</strong>以及一些<strong>外部目标文件（库文件）</strong>链接在一起，即<strong>进行内存布局的重新排列组合</strong>，整合成一个<strong>可执行文件</strong>。</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="链接器主要工作">链接器主要工作<a href="#链接器主要工作" class="hash-link" aria-label="链接器主要工作的直接链接" title="链接器主要工作的直接链接">​</a></h3><p><strong>汇编器输出的每个目标文件都有一个独立的程序内存布局</strong>，其描述了目标文件中的各个Section所在的位置，而<strong>链接器</strong>所做的事情就是<strong>将所有输入的目标文件独立的内存布局整合成一个整体的内存布局</strong>。</p><p>在此期间链接器主要完成了两件事情，具体如下：</p><p><img loading="lazy" alt="链接器主要工作" src="/note/zh-Hans/assets/images/link-sections-6de5aac6e394be5a6e4abc416abd8360.png" title="链接器主要工作" width="899" height="622" class="img_ev3q"></p><ol><li><p><strong>将所有输入的目标文件中的段进行重新排布，得到最终的目标内存布局</strong>。</p><p>如上图所示，链接过程中，分别将来自于不同目标文件<code>1.o</code>和<code>2.o</code>的段按照段的功能进行分类，相同功能的段会被排放拼装在一起，最终得到目标文件<code>output.o</code>。</p><p>此外，目标文件<code>1.o</code>和<code>2.o</code>的内存布局是存在冲突的，同一个地址在不同的内存布局中存放不同的内容，而在合并后的内存布局中，这些冲突将会被消除。</p></li><li><p><strong>将<code>符号</code>替换成具体的地址。</strong></p><ul><li><p>什么是<code>符号</code>？</p><p> <!-- --> <!-- -->在进行模块化编程的时候，每个模块都会提供一些向其他模块公开的（public属性的）全局变量、函数等以供让其他模块可以直接访问，同时也会访问其他模块公开的内容，要<code>访问一个变量或者一个函数</code>，在<code>源代码级别</code>，我们只需要<code>知道它们的名字即可直接调用</code>，这些<code>名字</code>就被称为<code>符号</code>。同时基于符号来自于模块内部还是其他模块，可以将进一步将符号分为<code>内部符号</code>和<code>外部符号</code>。</p><p> <!-- --> <!-- -->但是，在<code>机器码级别</code>，即目标文件或可执行文件中，并不是通过符号来索引想要访问的变量或者函数，而是<code>直接通过变量或者函数的地址来进行访问</code>，如，想要调用一个函数，需要在指令的机器码中找到函数入口的绝对地址或者相对于当前PC的相对地址，才能访问该函数。</p></li><li><p>符号<code>何时被替换成具体的地址</code>？</p><p> <!-- --> <!-- -->因为符号对应的变量是放在某个段中的固定位置的（如全局变量在<code>.bss</code>或者<code>.data</code>段中，函数则放在<code>.text</code>中），所以当符号所在的段在内存布局中的位置确定了，就能知道它们的具体地址了。</p><p> <!-- --> <!-- -->当一个<code>模块被转化为目标文件之后，它的内部符号在目标文件中就已经被转化成了具体地址</code>，因为先确定的内存布局才生成的目标文件，即目标文件给出了模块的内存布局，也就是说模块内的各个段的位置都已经被确定了。但是，模块所引用的外部符号的地址无法确定，只能将这些外部符号记录下来，放在目标文件中一个名为<code>符号表</code>的区域内，由于后续可能还需要重新定位（链接时，多个模块的内存布局会被合并），内部符号也同样被记录在符号表中。</p><p> <!-- --> <code>外部符号需要等到链接的时候才能够被转化为具体的地址</code>。假如模块1用到了模块2提供的内容，当两个模块的目标文件链接在一起的时候，它们的内存布局会被合并，即两个模块的各个段的位置在最终的目标文件中都被确定了下来，此时模块1用到的模块2的外部符号可以被转化为具体的地址。同时因为两个模块的段在合并后的内存布局中被重新排布，内部符号最终的地址可能和它们在模块自身的局部内存布局中相比已经发生了变化，因此需要进行地址修正，即重定位（R elocation）。</p></li></ul></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="链接脚本调整内存布局">链接脚本调整内存布局<a href="#链接脚本调整内存布局" class="hash-link" aria-label="链接脚本调整内存布局的直接链接" title="链接脚本调整内存布局的直接链接">​</a></h2><p>程序是在Qemu上运行的，这里的代码并不是完整的代码，这里主要是介绍链接脚本的作用。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="内核的第一条指令">内核的第一条指令<a href="#内核的第一条指令" class="hash-link" aria-label="内核的第一条指令的直接链接" title="内核的第一条指令的直接链接">​</a></h3><p>使用汇编指令编写进入内核后的第一条指令</p><div class="language-assembly codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-assembly codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"> # os/src/entry.asm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     .section .text.entry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     .globl _start</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> _start:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     li x1, 100</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="复制代码到剪贴板" title="复制" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>​</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="文件选项卡"><a class="pagination-nav__link pagination-nav__link--prev" href="/note/zh-Hans/rCore-Tutorial-Book学习/ch1-setup-os-devel-env"><div class="pagination-nav__sublabel">上一页</div><div class="pagination-nav__label">ch1-搭建OS实验环境</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#程序内存布局" class="table-of-contents__link toc-highlight">程序内存布局</a></li><li><a href="#编译与链接" class="table-of-contents__link toc-highlight">编译与链接</a><ul><li><a href="#简单编译流程" class="table-of-contents__link toc-highlight">简单编译流程</a></li><li><a href="#链接器主要工作" class="table-of-contents__link toc-highlight">链接器主要工作</a></li></ul></li><li><a href="#链接脚本调整内存布局" class="table-of-contents__link toc-highlight">链接脚本调整内存布局</a><ul><li><a href="#内核的第一条指令" class="table-of-contents__link toc-highlight">内核的第一条指令</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 qymlyl note</div></div></div></footer></div>
<script src="/note/zh-Hans/assets/js/runtime~main.cffa1f8f.js"></script>
<script src="/note/zh-Hans/assets/js/main.7f2867a2.js"></script>
</body>
</html>